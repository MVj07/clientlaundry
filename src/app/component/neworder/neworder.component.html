<app-header></app-header>
<section class="py-5">
  <div class="">
    <div class="form-box row">
      <div class="col-lg-8 offset-lg-2">
        <div class="save-boxs px-4 py-4">
          <form [formGroup]="newOrderForm">
            <div class="pt-1 row">
              <!-- <div class="col">
                <label class="form-label">B/no:</label>
                <input type="text" class="form-control" placeholder="B/no">
              </div> -->
              <h1 class="wd-title">Create Order</h1>
              <div class="col">
                <label class="form-label required">Kuri</label>
                <input formControlName="kuri" type="text" class="form-control" placeholder="Kuri/no" [ngClass]="{
                                'is-invalid': (submit && form['kuri'].errors) || (form['kuri'].invalid && (form['kuri'].dirty || form['kuri'].touched))
                                }">
                <div *ngIf="
                                    (submit && form['kuri'].errors) ||
                                    (form['kuri'].invalid &&
                                    (form['kuri'].dirty || form['kuri'].touched))
                                    " class="invalid-feedback">
                  <span *ngIf="form['kuri'].errors?.['required']">Kuri is required</span>
                </div>
              </div>
              <div class="col">
                <label class="form-label required">Date</label>
                <input formControlName="date" type="date" class="form-control" placeholder="" [ngClass]="{
                  'is-invalid': (submit && form['date'].errors) || (form['date'].invalid && (form['date'].dirty || form['date'].touched))
                }">
                <div *ngIf="
                                    (submit && form['date'].errors) ||
                                    (form['date'].invalid &&
                                    (form['date'].dirty || form['date'].touched))
                                    " class="invalid-feedback">
                  <span *ngIf="form['date'].errors?.['required']">Date is required</span>
                </div>
              </div>
            </div>
            <div class="pt-1">
              <label class="form-label required">Customer Name</label>
              <input formControlName="name" type="text" class="form-control" placeholder="Username" [ngClass]="{
                'is-invalid': (submit && form['name'].errors) || (form['name'].invalid && (form['name'].dirty || form['name'].touched))
              }">
              <div *ngIf="
                                                  (submit && form['name'].errors) ||
                                                  (form['name'].invalid &&
                                                  (form['name'].dirty || form['name'].touched))
                                                  " class="invalid-feedback">
                <span *ngIf="form['name'].errors?.['required']">name is required</span>
              </div>
            </div>

            <div class="pt-1">
              <label class="form-label required">Phone Number</label>
              <input formControlName="mobile" type="text" class="form-control" placeholder="Phone number" [ngClass]="{
                'is-invalid': (submit && form['mobile'].errors) || (form['mobile'].invalid && (form['mobile'].dirty || form['mobile'].touched))
              }">
              <div *ngIf="
                                                  (submit && form['mobile'].errors) ||
                                                  (form['mobile'].invalid &&
                                                  (form['mobile'].dirty || form['mobile'].touched))
                                                  " class="invalid-feedback">
                <span *ngIf="form['mobile'].errors?.['required']">mobile is required</span>
              </div>
            </div>
            <div class="pt-1">
              <label class="form-label required">Address</label>
              <input formControlName="address" type="text" class="form-control" placeholder="Address" [ngClass]="{
                'is-invalid': (submit && form['address'].errors) || (form['address'].invalid && (form['address'].dirty || form['address'].touched))
              }">
              <div *ngIf="
                                                  (submit && form['address'].errors) ||
                                                  (form['address'].invalid &&
                                                  (form['address'].dirty || form['address'].touched))
                                                  " class="invalid-feedback">
                <span *ngIf="form['address'].errors?.['required']">address is required</span>
              </div>
            </div>
          </form>

            <div class="row pt-1">
              <form [formGroup]="itemForm" (ngSubmit)="addOrder()">
                <div class="row pt-1">
                  <label class="required">Choose Items</label><br>
                  <div class="col-5 h-100">
                    <select formControlName="items" class="select-items"
                      [ngClass]="{'is-invalid': itemSubmit && itemControls['items'].invalid}">
                      <option [ngValue]="null" disabled>Select</option>
                      <option *ngFor="let item of orditems" [ngValue]="item">{{ item.name }}</option>
                    </select>
                    <div *ngIf="itemSubmit && itemControls['items'].invalid" class="invalid-feedback">
                      Item is required
                    </div>
                  </div>

                  <div class="col-2">
                    <div class="d-flex align-items-center">
                      <label class="form-label required">Qty:&nbsp;</label>
                      <input formControlName="quantity" type="number" class="form-control qty-box" placeholder="Qty"
                        [ngClass]="{'is-invalid': itemSubmit && itemControls['quantity'].invalid}">
                    </div>
                    <div *ngIf="itemSubmit && itemControls['quantity'].invalid" class="invalid-feedback">
                      Valid quantity is required
                    </div>
                  </div>

                  <div class="col-3">
                    <div class="d-flex align-items-center">
                      <label class="form-label required">Amount:&nbsp;</label>
                      <input formControlName="amount" type="number" class="form-control" placeholder="Amount"
                        [ngClass]="{'is-invalid': itemSubmit && itemControls['amount'].invalid}">
                    </div>
                    <div *ngIf="itemSubmit && itemControls['amount'].invalid" class="invalid-feedback">
                      Valid amount is required
                    </div>
                  </div>

                  <div class="col-2">
                    <div class="">
                      <button type="submit" class="primaryBtn">Add</button>
                    </div>
                  </div>
                </div>
              </form>



            </div>

          <div class="pt-1">
            <label>Items Details:</label>
            <table class="table table-striped table-bordered">
              <thead class="table-dark">
                <tr class="text-center">
                  <th>Product Name</th>
                  <th>Qty</th>
                  <th>Amount</th>
                  <th>Total Amount</th>
                  <th>Remove</th>
                </tr>
              </thead>
              <tbody *ngFor="let order of orders| paginate:{ itemsPerPage: 5, currentPage: p }; let i=index">
                <tr class="text-center">
                  <td>{{order.name}}</td>
                  <td>{{order.qty}}</td>
                  <td>{{order.price}}</td>
                  <td>{{order.qty * order.price}}</td>
                  <td> <button class="table-deletebtn" (click)="removeOrder(i)">Delete</button></td>
                </tr>
              </tbody>
            </table>
            <div class="pagination justify-content-center">
              <pagination-controls (pageChange)="p = $event"></pagination-controls>
            </div>
          </div>
          <div class="row ">
            <div class="col">
            </div>
            <div class="col">
              <div class="row">
                <div class="col-5  d-flex align-items-center justify-content-center">
                  <label class="form-label text-end">Total Amount :</label>
                </div>
                <div class="col-7">
                <input type="text" class="form-control" placeholder="Total amount" [value]="getTotalAmount()" readonly>

                  <!-- <input type="text" class="form-control" placeholder="Total amount"> -->
                </div>
              </div>
            </div>
          </div>
          <div class="pt-3 row">
            <div class="col">
              <button type="submit" class="primaryBtn" (click)="formSubmit()">Save</button>
            </div>
          </div>
        </div>
      </div>
      <div class="col">

      </div>
    </div>
  </div>
</section>